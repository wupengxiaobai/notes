[TOC]

# 方法

### 时间相关

##### 最常用的时间格式化

```js
/**
 * @param {Date} 时间实例
 * @param {String} 格式
 */
export const timeFmt = (date, fmt = 'yyyy/MM/dd') => {
    var o = {
        "M+": date.getMonth() + 1, //月份 
        "d+": date.getDate(), //日 
        "h+": date.getHours(), //小时 
        "m+": date.getMinutes(), //分 
        "s+": date.getSeconds(), //秒 
        "q+": Math.floor((date.getMonth() + 3) / 3), //季度 
        "S": date.getMilliseconds() //毫秒 
    };
    if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
    }
    for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
            fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        }
    }
    return fmt;
}
```
### 浅深拷贝
**FUNC1**
```JS
const cloneJSON = source => JSON.parse(JSON.stringify(source))
```
**FUNC2**
```JS
function cloneDeep(obj) {
    let family = {}
    let parent = Object.getPrototypeOf(obj)

    while (parent != null) {
        family = completeAssign(deepClone(family), parent)
        parent = Object.getPrototypeOf(parent)
    }

    // 下面这个函数会拷贝所有自有属性的属性描述符,来自于 MDN
    // https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign
    function completeAssign(target, ...sources) {
        sources.forEach(source => {
            let descriptors = Object.keys(source).reduce((descriptors, key) => {
                descriptors[key] = Object.getOwnPropertyDescriptor(source, key)
                return descriptors
            }, {})

            // Object.assign 默认也会拷贝可枚举的Symbols
            Object.getOwnPropertySymbols(source).forEach(sym => {
                let descriptor = Object.getOwnPropertyDescriptor(source, sym)
                if (descriptor.enumerable) {
                    descriptors[sym] = descriptor
                }
            })
            Object.defineProperties(target, descriptors)
        })
        return target
    }
    return completeAssign(deepClone(obj), family)
}
```
**FUNC3**
```JS
// 对象深拷贝
const deepClone = source => {
    function find(arr, item) {
        for (let i = 0; i < arr.length; i++) {
            if (arr[i].source === item) {
                return arr[i];
            }
        }
        return null;
    }
    const uniqueList = [];
    let root = {};
    const loopList = [{
        parent: root,
        key: undefined,
        data: source,
    }];
    while (loopList.length) {
        const node = loopList.pop();
        const parent = node.parent;
        const key = node.key;
        const data = node.data;
        let res = parent;
        if (typeof key !== 'undefined') {
            res = parent[key] = {};
        }
        let uniqueData = find(uniqueList, data);
        if (uniqueData) {
            parent[key] = uniqueData.target;
            continue;
        }
        uniqueList.push({
            source: data,
            target: res,
        });
        for (let k in data) {
            if (data.hasOwnProperty(k)) {
                if (typeof data[k] === 'object') {
                    loopList.push({
                        parent: res,
                        key: k,
                        data: data[k],
                    });
                } else {
                    res[k] = data[k];
                }
            }
        }
    }
    return root;
}
```

### 判断

##### 判断(包括object)是否为空，返回布尔值

```JS
function isEmpty(value) {
    return (
        value === undefined ||
        value === null ||
        (typeof value === "object" && Object.keys(value).length === 0) ||
        (typeof value === "string" && value.trim().length === 0)
    );
}
```

### 地址栏相关

##### 获取地址栏 query 信息（json）

```javascript
//  获取url地址?后参数, -> json 对象
function getUrlInfo() {
    let infoObj = {};
    if (window.location.search) {
        let infoTemp = window.location.search.replace('?', '');
        let infoTempArr = infoTemp.split('&');
        infoTempArr.forEach(function (item) {
            let temp = item.split('=');
            infoObj[temp[0]] = temp[1];
        })
    } else {
        return false;
    }
    return infoObj;
}
```

##### 获取地址栏中指定 key 对应 value 

```js
/**
 * 获取地址栏信息
 * @param {*} key 参数名 
 */
var GetQueryString = function (key) {
    var reg = new RegExp("(^|&)" + key + "=([^&]*)(&|$)");
    var r = window.location.search.substr(1).match(reg);
    if (r != null) return unescape(r[2]);
    return null;
}
```

###  表单处理

##### 表单数据序列化

```javascript
//  表单数据序列化
function serialize2json(formData) {
    let formObject = {};
    let formArr = formData.split('&');
    formArr.forEach(function (item, i) {
        let temp = item.split('=');
        formObject[temp[0]] = temp[1];
    })
    return formObject;
}
```

### 上传相关

##### 上传图片前端显示函数

```js
/**
*	@param {fileDom} file控件
*/
function imgPreview(fileDom){
    //判断是否支持FileReader
    if (window.FileReader) {
        var reader = new FileReader();
    } else {
        alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");
    }
    //获取文件
    var file = fileDom.files[0];
    var imageType = /^image\//;
    //是否是图片
    if (!imageType.test(file.type)) {
        alert("请选择图片！");
        return;
    }
    //读取完成
    reader.onload = function(e) {
        //获取图片dom, 修改路径
        var img = document.getElementById("preview");
        //图片路径设置为读取的图片
        img.src = e.target.result;
    };
    reader.readAsDataURL(file);
}
```



### 正则相关

```js
//	手机号码 isPoneAvailable(18958849752)
var isPoneAvailable = $phonenumber => /^[1][3,4,5,7,8][0-9]{9}$/.test($phonenumber)

//	去除两边空格
var trim = str => str.replace(/^\s+|\s+$/g, "")

//	邮箱
var emailVerify = email => (/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/).test(email).
```



# 依赖

### jwt

#### 身份令牌

##### 生成 token

`jsonwebtoken` 依赖，用于生成 token

##### 解析 token 
